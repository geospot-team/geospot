Поиск объектов в радиусе

Параметры запуска:

1) первые 2 аргумента — входной и выходной файл
2) опциональный 3 аргумент — hash
Тогда используется hash для поиска точек
Требуется еще 5 параметров:
lat lon lat lon bins
bins — размер дискретизации сетки
lat,lon — нижний левый и правый верхний углы

Входной файл:
n
id lat lon (n lines)

locationsCount
distance
lat lon (locations)


Выходной файл:
json dict в формате
{lat,lon} : [ ids]
Маппит координаты в объекты